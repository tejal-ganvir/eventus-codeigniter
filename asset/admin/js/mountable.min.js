/* Mountable | Developed by Guilherme Augusto Madaleno <guimadaleno@me.com> | www.guimadaleno.com | (C) 2014 All rights reserved | Licensed under GNU GPL */
$.fn.mounTable=function(g,l){var e,m,b,i,d,f;var k=(l&&l.noDebug)?false:true;var h=(l&&l.model)?l.model:".mountable-model";var c=Object.keys($(j).find(h)).length;var a=(l&&l.addLine&&l.addLine.button)?l.addLine.button:".mountable-new-line";var j=this;if(g&&g.length){if(!$(j).length){if(k){console.log("MounTable: Table "+j.selector+" not found!")}}else{$.each(g,function(o,n){if(n){$.each(n,function(q,p){if($.type(p)==="string"||$.type(p)==="number"){e=$(j).find(h).find('input[name="'+q+'[]"], input[name="'+q+'"], select[name="'+q+'[]"], select[name="'+q+'"]');if(e.prop("tagName")=="INPUT"){if(e.attr("type")=="text"){e.attr("value",p)}else{if(e.attr("type")=="checkbox"){if(e.length>1){$.each(e,function(r,s){if(s.value==p){s.setAttribute("checked","checked")}else{s.removeAttribute("checked")}})}}}}else{if(e.prop("tagName")=="SELECT"){e.val(p);e.children("option").attr("selected",false);e.children('option[value="'+p+'"]').attr("selected","selected")}}}else{if($.type(p)==="array"){e=$(j).find(h).find('select[name="'+q+'[]"], select[name="'+q+'"]');if(e.prop("tagName")=="SELECT"){selectOpts=false;$.each(p,function(r,s){selectOpts+='<option value="'+s+'">'+s+"</option>"});e.html(selectOpts);e.attr("data-mountable-filled-up-selectbox","yes")}}}});b=$(j).find(h).html();$(j).find(h).parent().append("<tr>"+b+"</tr>");$(j).find(h+" input").each(function(){if($(this).prop("type")=="text"){$(this).attr("value","")}else{if($(this).prop("type")=="checkbox"){$(this).each(function(){$(this).attr("checked",false)})}}});$(j).find(h+" select").each(function(){$(this).find("option").each(function(){$(this).removeAttr("selected")});$(this).attr("value","");if($(this).attr("data-mountable-filled-up-selectbox")=="yes"){$(this).html(" ")}})}})}d="<tr>"+$(j).find(h).html()+"</tr>";i=$(j).find(h).parent();if(k){console.log("MounTable: content successfully mounted on "+j.selector)}deleteLine=function(){if(l&&l.deleteLine&&l.deleteLine.button){$(l.deleteLine.button).off("click").on("click",function(){if(l.deleteLine.onClick&&$.type(l.deleteLine.onClick)==="function"){if(l.deleteLine.onClick()===true){$(this).parent().parent().remove()}}else{$(this).parent().parent().remove()}})}};$(a).off("click").on("click",function(){i.append(d);deleteLine();if(l.addLine.onClick&&$.type(l.addLine.onClick)==="function"){l.addLine.onClick()}});deleteLine();$(j).find(h).remove()}};